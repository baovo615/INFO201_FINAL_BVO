leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
total.arena.stats <- rbind(team.arena.stats1, team.arena.stats3)
halo.stats3 <- GetStats(1,32)
View(halo.stats3)
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
for(i in 2:5) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats3 <- GetStats(1,5)
View(halo.stats3)
for(i in 2:4) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
team.arena.stats <- rbind(team.arena.stats, x)
}
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
for(i in 2:4) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats3 <- GetStats(2,5)
View(halo.stats3)
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
for(i in 2:(rank2 - rank1 +1)) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats3 <- GetStats(3,9)
View(halo.stats3)
halo.stats1 <- GetStats(1,32)
halo.stats2 <- GetStats(33,64)
halo.stats3 <- GetStats(65,96)
rbind(halo.stats1, halo.stats2, halo.stats3)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3)
View(total.halo.stats)
halo.stats4 <- GetStats(97, 128)
library("shiny")
library("rlang")
library("httr")
# install.packages("")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stringr")
library("jsonlite")
source("api_key.R")
halo.stats4 <- GetStats(97, 128)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
# Luxi Zheng
library("shiny")
library("rlang")
library("httr")
# install.packages("")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stringr")
library("jsonlite")
source("api_key.R")
###################################################
########## Process the data #######################
###################################################
# to get a list of playlists that are ranked and active so we know
# which ones to display to the reader
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/playlists"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
playlists <- fromJSON(content(response, "text"))
playlists <- playlists %>%
filter(isRanked == TRUE & isActive == TRUE) %>%
select(name, description, gameMode, id)
# team arena's id c98949ae-60a8-43dc-85d7-0feb0b92e719
# to get the most recent finished season
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/seasons"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
seasons <- fromJSON(content(response, "text"))
latest.finished.season.id <- seasons %>%
filter(isActive == FALSE) %>% filter(row_number()==n()) %>% select(id)
latest.finished.season.id <- latest.finished.season.id[1, 1]
# the most recent finished season id f7b4e7b4-8f70-431d-b604-d13cffff1114
base.uri <- "https://www.haloapi.com/stats/h5/player-leaderboards/csr/"
# resource {seasonId}/{playlistId}
resource.uri <- paste0(latest.finished.season.id, "/c98949ae-60a8-43dc-85d7-0feb0b92e719")
uri <- paste0(base.uri, resource.uri)
response <- GET(uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
response <- fromJSON(content(response, "text"))
leaders <- response$Results %>%
flatten()
# service information of top players
base.uri.stats <- "https://www.haloapi.com/stats/"
arena.columns <- c("TotalKills", "TotalDeaths", "TotalShotsFired",
"TotalShotsLanded", "TotalMeleeKills", "TotalGrenadeKills",
"TotalTimePlayed","TotalGamesCompleted", "TotalGamesWon",
"TotalGamesLost","TotalGamesTied")
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
for(i in 2:(rank2 - rank1 +1)) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats1 <- GetStats(1,32)
halo.stats2 <- GetStats(33,64)
halo.stats3 <- GetStats(65,96)
halo.stats4 <- GetStats(97, 128)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
library(shiny)
# Define UI for application that draws a histogram
my.ui <- fluidPage(
# Application title
titlePanel("HALO 5"),
h4("By: Luxi Zheng \n02/23/2018"),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
checkboxGroupInput('playlists',
'Playlists:',
1998:2014, selected = c(2000, 2010)),
sliderInput("range",
"Range of ranked players: ",
min = 0,
max = 250,
value = c(0, 100)),
width = 3
),
# create the different tabs plus text to go along with each tab
mainPanel()
)
)
shinyUI(my.ui)
shiny::runApp()
library("tidyr")
install.packages("tidyr")
install.packages("tidyr")
library("shiny")
library("rlang")
#install.packages("tidyr")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stringr")
library("jsonlite")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
# Luxi Zheng
library("shiny")
library("rlang")
library("httr")
#install.packages("tidyr")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stringr")
library("jsonlite")
source("api_key.R")
###################################################
########## Process the data #######################
###################################################
# to get a list of playlists that are ranked and active so we know
# which ones to display to the reader
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/playlists"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
playlists <- fromJSON(content(response, "text"))
playlists <- playlists %>%
filter(isRanked == TRUE & isActive == TRUE) %>%
select(name, description, gameMode, id)
# team arena's id c98949ae-60a8-43dc-85d7-0feb0b92e719
# to get the most recent finished season
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/seasons"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
seasons <- fromJSON(content(response, "text"))
latest.finished.season.id <- seasons %>%
filter(isActive == FALSE) %>% filter(row_number()==n()) %>% select(id)
latest.finished.season.id <- latest.finished.season.id[1, 1]
# the most recent finished season id f7b4e7b4-8f70-431d-b604-d13cffff1114
base.uri <- "https://www.haloapi.com/stats/h5/player-leaderboards/csr/"
# resource {seasonId}/{playlistId}
resource.uri <- paste0(latest.finished.season.id, "/c98949ae-60a8-43dc-85d7-0feb0b92e719")
uri <- paste0(base.uri, resource.uri)
response <- GET(uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
response <- fromJSON(content(response, "text"))
leaders <- response$Results %>%
flatten()
# service information of top players
base.uri.stats <- "https://www.haloapi.com/stats/"
arena.columns <- c("TotalKills", "TotalDeaths", "TotalShotsFired",
"TotalShotsLanded", "TotalMeleeKills", "TotalGrenadeKills",
"TotalTimePlayed","TotalGamesCompleted", "TotalGamesWon",
"TotalGamesLost","TotalGamesTied")
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
for(i in 2:(rank2 - rank1 +1)) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "c98949ae-60a8-43dc-85d7-0feb0b92e719")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats1 <- GetStats(1,32)
halo.stats2 <- GetStats(33,64)
halo.stats3 <- GetStats(65,96)
halo.stats4 <- GetStats(97, 128)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
runApp()
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed))
install.packages("lubridate")
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed))
library("lubridate")
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed))
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed / 3600))
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed))
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed/ 3600))
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed) / 3600)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed) / 3600)
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed)) %>%
mutate(time / 3600)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed)) %>%
mutate(time / 3600)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed)) %>%
mutate(time = time / 3600)
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed))
total.halo.stats[1,1]
total.halo.stats[,1]
total.halo.stats[1,]
total.halo.stats <- mutate(total.halo.stats, time = as.duration(TotalTimePlayed) /3600)
total.halo.stats[1,]
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = as.numeric(as.duration(TotalTimePlayed), hours))
getwd()
source('D:/Desktop/Info 201/assignments/INFO201_FINAL_BVO/script_final.R', echo=TRUE)
halo.stats3 <- GetStats(65,96)
halo.stats4 <- GetStats(97, 128)
source("scipt_final.R")
source("scipt_final.R")
source("script_final.R")
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = as.double(as.duration(TotalTimePlayed)))
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = round(as.double(as.duration(TotalTimePlayed)) / 3600))
View(playlists)
# Luxi Zheng
library("shiny")
library("rlang")
library("httr")
#install.packages("lubridate")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stringr")
library("jsonlite")
library("lubridate")
source("api_key.R")
###################################################
########## Process the data #######################
###################################################
# to get a list of playlists that are ranked and active so we know
# which ones to display to the reader
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/playlists"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
playlists <- fromJSON(content(response, "text"))
playlists <- playlists %>%
filter(isRanked == TRUE & isActive == TRUE) %>%
select(name, description, gameMode, id)
# team arena's id c98949ae-60a8-43dc-85d7-0feb0b92e719
# to get the most recent finished season
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/seasons"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
seasons <- fromJSON(content(response, "text"))
latest.finished.season.id <- seasons %>%
filter(isActive == FALSE) %>% filter(row_number()==n()) %>% select(id)
latest.finished.season.id <- latest.finished.season.id[1, 1]
# the most recent finished season id f7b4e7b4-8f70-431d-b604-d13cffff1114
base.uri <- "https://www.haloapi.com/stats/h5/player-leaderboards/csr/"
# resource {seasonId}/{playlistId}
resource.uri <- paste0(latest.finished.season.id, "/c98949ae-60a8-43dc-85d7-0feb0b92e719")
uri <- paste0(base.uri, resource.uri)
response <- GET(uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
response <- fromJSON(content(response, "text"))
leaders <- response$Results %>%
flatten()
# service information of top players
base.uri.stats <- "https://www.haloapi.com/stats/"
arena.columns <- c("TotalKills", "TotalDeaths", "TotalShotsFired",
"TotalShotsLanded", "TotalMeleeKills", "TotalGrenadeKills",
"TotalTimePlayed","TotalGamesCompleted", "TotalGamesWon",
"TotalGamesLost","TotalGamesTied")
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "5c9808b0-03a3-4577-b966-7217f9dda52d")
for(i in 2:(rank2 - rank1 +1)) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "5c9808b0-03a3-4577-b966-7217f9dda52d")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats1 <- GetStats(1,32)
halo.stats2 <- GetStats(33,64)
halo.stats3 <- GetStats(65,96)
halo.stats4 <- GetStats(97, 128)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time = round(as.double(as.duration(TotalTimePlayed)) / 3600))
write.csv()
source('D:/Desktop/Info 201/assignments/INFO201_FINAL_BVO/script_final.R', echo=TRUE)
View(total.halo.stats)
getwd()
write.csv(total.halo.stats, "INFO201_FINAL_BVO/data")
write.csv(total.halo.stats, "INFO201_FINAL_BVO/data")
write.csv(total.halo.stats, file = "INFO201_FINAL_BVO/data/halo.stats.csv")
write.csv(total.halo.stats, file = "data/halo.stats.csv")
# Luxi Zheng
library("shiny")
library("rlang")
library("httr")
#install.packages("lubridate")
library("dplyr")
library("tidyr")
library("ggplot2")
library("stringr")
library("jsonlite")
library("lubridate")
source("api_key.R")
###################################################
########## Process the data #######################
###################################################
# to get a list of playlists that are ranked and active so we know
# which ones to display to the reader
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/playlists"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
playlists <- fromJSON(content(response, "text"))
playlists <- playlists %>%
filter(isRanked == TRUE & isActive == TRUE) %>%
select(name, description, gameMode, id)
# team arena's id c98949ae-60a8-43dc-85d7-0feb0b92e719
# to get the most recent finished season
base.uri <- "https://www.haloapi.com/metadata/h5/metadata/seasons"
response <- GET(base.uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
seasons <- fromJSON(content(response, "text"))
latest.finished.season.id <- seasons %>%
filter(isActive == FALSE) %>% filter(row_number()==n()) %>% select(id)
latest.finished.season.id <- latest.finished.season.id[1, 1]
# the most recent finished season id f7b4e7b4-8f70-431d-b604-d13cffff1114
base.uri <- "https://www.haloapi.com/stats/h5/player-leaderboards/csr/"
# resource {seasonId}/{playlistId}
resource.uri <- paste0(latest.finished.season.id, "/5c9808b0-03a3-4577-b966-7217f9dda52d")
uri <- paste0(base.uri, resource.uri)
response <- GET(uri, add_headers('Ocp-Apim-Subscription-Key' = api.key))
response <- fromJSON(content(response, "text"))
leaders <- response$Results %>%
flatten()
# service information of top players
base.uri.stats <- "https://www.haloapi.com/stats/"
arena.columns <- c("TotalKills", "TotalDeaths", "TotalShotsFired",
"TotalShotsLanded", "TotalMeleeKills", "TotalGrenadeKills",
"TotalTimePlayed","TotalGamesCompleted", "TotalGamesWon",
"TotalGamesLost","TotalGamesTied")
GetStats <- function(rank1, rank2) {
player.ids <- leaders$Player.Gamertag
player.ids <- player.ids[rank1:rank2]
nospace.ids <- paste0(player.ids, collapse = ",")
nospace.ids <- gsub(" ", "+", nospace.ids)
resource.stats <- paste0("h5/servicerecords/arena?players=", nospace.ids,"&seasonId=", latest.finished.season.id)
uri.stats <- paste0(base.uri.stats, resource.stats)
halo.stats <- GET(uri.stats, add_headers("Ocp-Apim-Subscription-Key" = api.key)) %>%
content("text") %>%
fromJSON()
halo.frame <- data.frame(halo.stats$Results)
halo.frame1 <- halo.frame$Result$ArenaStats$ArenaPlaylistStats
team.arena.stats <- data.frame(halo.frame1[[1]]) %>%
flatten()
team.arena.stats <- filter(team.arena.stats, PlaylistId == "5c9808b0-03a3-4577-b966-7217f9dda52d")
for(i in 2:(rank2 - rank1 +1)) {
x <- data.frame(halo.frame1[[i]]) %>%
flatten()
x <- filter(x, PlaylistId == "5c9808b0-03a3-4577-b966-7217f9dda52d")
team.arena.stats <- rbind(team.arena.stats, x)
}
team.arena.stats1 <- select(team.arena.stats, arena.columns)
leaders.counted <- leaders[rank1:rank2,]
team.arena.stats1 <- cbind(player.ids, rank = leaders.counted$Rank, team.arena.stats1, xp = halo.frame$Result$Xp)
}
halo.stats1 <- GetStats(1,32)
halo.stats2 <- GetStats(33,64)
halo.stats3 <- GetStats(65,96)
halo.stats4 <- GetStats(97, 128)
total.halo.stats <- rbind(halo.stats1, halo.stats2, halo.stats3, halo.stats4)
total.halo.stats <- mutate(total.halo.stats, time(h) = round(as.double(as.duration(TotalTimePlayed)) / 3600))
write.csv(total.halo.stats, file = "data/halo.stats.csv")
View(total.halo.stats)
total.halo.stats <- mutate(total.halo.stats, "time(h)" = round(as.double(as.duration(TotalTimePlayed)) / 3600))
write.csv(total.halo.stats, file = "data/halo.stats.csv")
